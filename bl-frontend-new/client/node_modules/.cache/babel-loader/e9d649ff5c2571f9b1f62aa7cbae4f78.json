{"ast":null,"code":"import { ADD_CONTENTS_DATA, ADD_FOLLOWS_DATA, SET_TOTAL_VALUE, CLEAR_ALL_CONTENTS_DATA, MY_FOLLOW } from '../constants';\n\nvar _ = require('lodash');\n\nconst initialState = {\n  total_value: 0,\n  data: [],\n  follows: []\n};\n\nconst app = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_CONTENTS_DATA:\n      {\n        let merged = _.merge(_.keyBy(state.data, 'nid'), _.keyBy(action.data, 'nid'));\n\n        return { ...state,\n          data: _.values(merged)\n        };\n      }\n\n    case SET_TOTAL_VALUE:\n      {\n        return { ...state,\n          total_value: action.data\n        };\n      }\n\n    case MY_FOLLOW:\n      {\n        let state_data = state.data;\n        let action_data = action.data;\n        let find_content = state_data.find(o => o.nid == action_data.nid);\n\n        if (!_.isEmpty(find_content)) {\n          if (_.has(find_content, 'app_followers')) {\n            let app_followers = find_content.app_followers; // app_followers = [...app_followers, {uid: action_data.uid, status: true, date  : Date.now()}]\n          }\n        }\n\n        console.log('MY_FOLLOW > ', find_content);\n        /*\n        let index = state_data.findIndex((obj => obj.nid == action_data.nid));\n        \n        let __t = state_data[index];\n        if(!_.isEmpty(__t)){\n          let app_followers = __t.app_followers\n             let _index = app_followers.findIndex((obj => obj.uid == action_data.uid));\n          if(_index === -1){\n            app_followers = [...app_followers, {uid: action_data.uid, status: true, date  : Date.now()}]\n          }else{\n            app_followers[_index].status = action_data.status\n            console.log('app_followers :', app_followers, app_followers[_index].status)\n          }\n           state_data.splice(index,1, {...__t, app_followers})\n        }\n         return { ...state, data: state_data};\n        */\n\n        return state;\n      }\n\n    case ADD_FOLLOWS_DATA:\n      {\n        let merged = _.merge(_.keyBy(state.follows, 'nid'), _.keyBy(action.data, 'nid'));\n\n        return { ...state,\n          follows: _.values(merged)\n        };\n      }\n\n    case CLEAR_ALL_CONTENTS_DATA:\n      {\n        return initialState;\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default app;","map":{"version":3,"sources":["/app/src/reducers/app.js"],"names":["ADD_CONTENTS_DATA","ADD_FOLLOWS_DATA","SET_TOTAL_VALUE","CLEAR_ALL_CONTENTS_DATA","MY_FOLLOW","_","require","initialState","total_value","data","follows","app","state","action","type","merged","merge","keyBy","values","state_data","action_data","find_content","find","o","nid","isEmpty","has","app_followers","console","log"],"mappings":"AAAA,SAASA,iBAAT,EAA4BC,gBAA5B,EAA8CC,eAA9C,EAA+DC,uBAA/D,EAAwFC,SAAxF,QAAyG,cAAzG;;AAEA,IAAIC,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAf;;AAEA,MAAMC,YAAY,GAAG;AACnBC,EAAAA,WAAW,EAAE,CADM;AAEnBC,EAAAA,IAAI,EAAE,EAFa;AAGnBC,EAAAA,OAAO,EAAE;AAHU,CAArB;;AAMA,MAAMC,GAAG,GAAG,CAACC,KAAK,GAAGL,YAAT,EAAuBM,MAAvB,KAAkC;AAC5C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKd,iBAAL;AAAuB;AACrB,YAAIe,MAAM,GAAGV,CAAC,CAACW,KAAF,CAAQX,CAAC,CAACY,KAAF,CAAQL,KAAK,CAACH,IAAd,EAAoB,KAApB,CAAR,EAAoCJ,CAAC,CAACY,KAAF,CAAQJ,MAAM,CAACJ,IAAf,EAAqB,KAArB,CAApC,CAAb;;AACA,eAAO,EAAE,GAAGG,KAAL;AAAYH,UAAAA,IAAI,EAAEJ,CAAC,CAACa,MAAF,CAASH,MAAT;AAAlB,SAAP;AACD;;AAED,SAAKb,eAAL;AAAqB;AACnB,eAAO,EAAE,GAAGU,KAAL;AAAYJ,UAAAA,WAAW,EAAEK,MAAM,CAACJ;AAAhC,SAAP;AACD;;AAED,SAAKL,SAAL;AAAe;AACb,YAAIe,UAAU,GAAIP,KAAK,CAACH,IAAxB;AACA,YAAIW,WAAW,GAAGP,MAAM,CAACJ,IAAzB;AAEA,YAAIY,YAAY,GAAGF,UAAU,CAACG,IAAX,CAAiBC,CAAD,IAAOA,CAAC,CAACC,GAAF,IAASJ,WAAW,CAACI,GAA5C,CAAnB;;AACA,YAAG,CAACnB,CAAC,CAACoB,OAAF,CAAUJ,YAAV,CAAJ,EAA4B;AAC1B,cAAGhB,CAAC,CAACqB,GAAF,CAAML,YAAN,EAAoB,eAApB,CAAH,EAAwC;AACtC,gBAAIM,aAAa,GAAGN,YAAY,CAACM,aAAjC,CADsC,CAEtC;AACD;AACF;;AAEDC,QAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BR,YAA5B;AACA;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAOM,eAAOT,KAAP;AACD;;AAED,SAAKX,gBAAL;AAAuB;AACrB,YAAIc,MAAM,GAAGV,CAAC,CAACW,KAAF,CAAQX,CAAC,CAACY,KAAF,CAAQL,KAAK,CAACF,OAAd,EAAuB,KAAvB,CAAR,EAAuCL,CAAC,CAACY,KAAF,CAAQJ,MAAM,CAACJ,IAAf,EAAqB,KAArB,CAAvC,CAAb;;AACA,eAAO,EAAE,GAAGG,KAAL;AAAYF,UAAAA,OAAO,EAAEL,CAAC,CAACa,MAAF,CAASH,MAAT;AAArB,SAAP;AACD;;AAED,SAAKZ,uBAAL;AAA6B;AAC3B,eAAOI,YAAP;AACD;;AAED;AACE,aAAOK,KAAP;AA3DJ;AA6DD,CA9DD;;AAgEA,eAAeD,GAAf","sourcesContent":["import { ADD_CONTENTS_DATA, ADD_FOLLOWS_DATA, SET_TOTAL_VALUE, CLEAR_ALL_CONTENTS_DATA, MY_FOLLOW } from '../constants';\n\nvar _ = require('lodash');\n\nconst initialState = {\n  total_value: 0,\n  data: [],\n  follows: []\n}\n\nconst app = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_CONTENTS_DATA:{\n      let merged = _.merge(_.keyBy(state.data, 'nid'), _.keyBy(action.data, 'nid'));\n      return { ...state, data: _.values(merged)}\n    }\n\n    case SET_TOTAL_VALUE:{\n      return { ...state, total_value: action.data}\n    }\n\n    case MY_FOLLOW:{\n      let state_data  = state.data\n      let action_data = action.data;\n\n      let find_content = state_data.find((o) => o.nid == action_data.nid)\n      if(!_.isEmpty(find_content)){\n        if(_.has(find_content, 'app_followers')){\n          let app_followers = find_content.app_followers\n          // app_followers = [...app_followers, {uid: action_data.uid, status: true, date  : Date.now()}]\n        }\n      }\n\n      console.log('MY_FOLLOW > ', find_content)\n      /*\n      let index = state_data.findIndex((obj => obj.nid == action_data.nid));\n      \n      let __t = state_data[index];\n      if(!_.isEmpty(__t)){\n        let app_followers = __t.app_followers\n\n\n\n        let _index = app_followers.findIndex((obj => obj.uid == action_data.uid));\n        if(_index === -1){\n          app_followers = [...app_followers, {uid: action_data.uid, status: true, date  : Date.now()}]\n        }else{\n          app_followers[_index].status = action_data.status\n          console.log('app_followers :', app_followers, app_followers[_index].status)\n        }\n\n        state_data.splice(index,1, {...__t, app_followers})\n      }\n\n      return { ...state, data: state_data};\n      */\n\n      return state\n    }\n\n    case ADD_FOLLOWS_DATA: {\n      let merged = _.merge(_.keyBy(state.follows, 'nid'), _.keyBy(action.data, 'nid'));\n      return { ...state, follows: _.values(merged)}\n    }\n\n    case CLEAR_ALL_CONTENTS_DATA:{\n      return initialState\n    }\n      \n    default:\n      return state;\n  }\n}\n\nexport default app"]},"metadata":{},"sourceType":"module"}