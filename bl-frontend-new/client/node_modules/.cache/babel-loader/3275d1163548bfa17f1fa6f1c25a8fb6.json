{"ast":null,"code":"var _jsxFileName = \"/app/src/pages/DetailPage.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useLayoutEffect, useRef } from \"react\";\nimport { connect } from 'react-redux';\nimport { useHistory } from \"react-router-dom\";\nimport { toast } from 'react-toastify';\nimport Lightbox from \"react-image-lightbox\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\nimport moment from \"moment\";\nimport { CircularProgress } from '@material-ui/core';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport MoreVertOutlinedIcon from '@material-ui/icons/MoreVertOutlined';\nimport VerifiedUserOutlinedIcon from '@material-ui/icons/VerifiedUserOutlined';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport axios from 'axios';\nimport LoginDialog from './LoginDialog';\nimport { isEmpty, commaFormatted } from \"../utils\";\nimport ReportDialog from './ReportDialog'; // Hook\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction usePrevious(value) {\n  _s();\n\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef(); // Store current value in ref\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n  // Return previous value (happens before update in useEffect above)\n\n  return ref.current;\n}\n\n_s(usePrevious, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n\nconst DetailPage = props => {\n  _s2();\n\n  const history = useHistory();\n  const [item, setItem] = React.useState(null);\n  const [nid, setNid] = React.useState(0);\n  const [isOpen, setIsOpen] = React.useState(false);\n  const [showModalLogin, setShowModalLogin] = React.useState(false);\n  const [showModalReport, setShowModalReport] = React.useState(false);\n  const [photoIndex, setPhotoIndex] = React.useState(0);\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const prevNid = usePrevious(props.match.params.nid);\n  useEffect(async () => {\n    let {\n      state\n    } = props.location;\n    let {\n      match\n    } = props;\n    setNid(match.params.nid);\n\n    if (state === undefined) {\n      let response = await axios.post(`/api/v1/search`, {\n        type: 2,\n        key_word: props.match.params.nid,\n        offset: 0\n      }, {\n        headers: {\n          'Authorization': `Basic ${process.env.REACT_APP_AUTHORIZATION}`\n        }\n      });\n      response = response.data;\n\n      if (response.result) {\n        console.log(\"/api/v1/search : response =\", response);\n        let {\n          datas\n        } = response;\n\n        if (!isEmpty(datas)) {\n          setItem(datas[0]);\n        }\n      }\n    } else {\n      setItem(state.item);\n      console.log('state.item :', state.item, props.history);\n    }\n\n    resetScroll();\n  }, [props.location]);\n\n  const resetScroll = () => {\n    if (nid !== prevNid) {\n      window.scrollTo(0, 0);\n    }\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [showModalReport && /*#__PURE__*/_jsxDEV(ReportDialog, {\n      showModal: showModalReport,\n      onClose: () => {\n        setShowModalReport(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 34\n    }, this), isEmpty(item) ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\" \", /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 27\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D-\\u0E19\\u0E32\\u0E21\\u0E2A\\u0E01\\u0E38\\u0E25 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.name_surname\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32/\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E22\\u0E2D\\u0E14\\u0E40\\u0E07\\u0E34\\u0E19 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: !isEmpty(item.transfer_amount) ? commaFormatted(item.transfer_amount) : item.transfer_amount\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"\\u0E27\\u0E31\\u0E19\\u0E42\\u0E2D\\u0E19\\u0E40\\u0E07\\u0E34\\u0E19: \", moment(item.transfer_date).format('MMM DD, YYYY')]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 27\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E15\\u0E34\\u0E21 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.detail\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(VerifiedUserOutlinedIcon, {\n          style: {\n            cursor: 'pointer'\n          },\n          onClick: () => {\n            if (isEmpty(props.user)) {\n              setShowModalLogin(true);\n            } else {\n              toast.info(\"Follow up or Unfollow up\", {\n                position: \"bottom-right\",\n                hideProgressBar: true,\n                autoClose: 1000\n              });\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(MoreVertOutlinedIcon, {\n          style: {\n            cursor: 'pointer'\n          },\n          onClick: e => {\n            setAnchorEl(e.currentTarget);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row d-flex flex-row py-5\",\n        children: !isEmpty(item.images) && item.images[0].map((item, index) => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              margin: 10,\n              cursor: 'pointer'\n            },\n            onClick: () => {\n              setIsOpen(true);\n              setPhotoIndex(index);\n            },\n            children: /*#__PURE__*/_jsxDEV(LazyLoadImage, {\n              className: \"lazy-load-image\",\n              alt: 'image.alt',\n              width: \"250px\",\n              height: \"250px\",\n              effect: \"blur\" // placeholderSrc={'<div className=\"abc\">' + previewIcon + '<div>'}\n              ,\n              placeholder: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  textAlign: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"loading...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 148\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 114\n              }, this),\n              src: item.url\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 97\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 92\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 25\n      }, this), isOpen && !isEmpty(item.images) && /*#__PURE__*/_jsxDEV(Lightbox, {\n        mainSrc: item.images[0][photoIndex].url,\n        nextSrc: item.images[0][(photoIndex + 1) % item.images[0].length].url,\n        prevSrc: item.images[0][(photoIndex + item.images[0].length - 1) % item.images[0].length].url,\n        imageTitle: photoIndex + 1 + \"/\" + item.images[0].length // mainSrcThumbnail={images[photoIndex]}\n        // nextSrcThumbnail={images[(photoIndex + 1) % images.length]}\n        // prevSrcThumbnail={images[(photoIndex + images.length - 1) % images.length]}\n        ,\n        onCloseRequest: () => setIsOpen(false),\n        onMovePrevRequest: () => // this.setState({\n        //     photoIndex: (photoIndex + images.length - 1) % images.length\n        // })\n        setPhotoIndex((photoIndex + item.images[0].length - 1) % item.images[0].length),\n        onMoveNextRequest: () => // this.setState({\n        //     photoIndex: (photoIndex + 1) % images.length\n        // })\n        setPhotoIndex((photoIndex + 1) % item.images[0].length)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 67\n      }, this), /*#__PURE__*/_jsxDEV(Menu, {\n        keepMounted: true,\n        anchorEl: anchorEl,\n        onClose: handleClose,\n        open: Boolean(anchorEl),\n        children: [/*#__PURE__*/_jsxDEV(CopyToClipboard, {\n          text: \"http://localhost:8099/detail/\" + item.id,\n          children: /*#__PURE__*/_jsxDEV(MenuItem, {\n            onClick: () => {\n              toast.info(\"Link to post copied to clipboard.\", {\n                position: \"bottom-right\",\n                hideProgressBar: true,\n                autoClose: 1000\n              });\n              handleClose();\n            },\n            children: \"Copy link\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n          onClick: () => {\n            if (isEmpty(props.user)) {\n              setShowModalLogin(true);\n            } else {\n              setShowModalReport(true);\n            }\n\n            handleClose();\n          },\n          children: \"Report\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 25\n      }, this), showModalLogin && /*#__PURE__*/_jsxDEV(LoginDialog, {\n        showModal: showModalLogin,\n        onClose: () => {\n          setShowModalLogin(false);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 46\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 21\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(DetailPage, \"N4RFV9GRPs9yIi1GQXBNsTgujG8=\", false, function () {\n  return [useHistory, usePrevious];\n});\n\n_c = DetailPage;\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    user: state.user.data,\n    data: state.app.data\n  };\n};\n\nconst mapDispatchToProps = {// fetchData,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(DetailPage);\n\nvar _c;\n\n$RefreshReg$(_c, \"DetailPage\");","map":{"version":3,"sources":["/app/src/pages/DetailPage.js"],"names":["React","useEffect","useLayoutEffect","useRef","connect","useHistory","toast","Lightbox","MenuItem","Menu","moment","CircularProgress","CopyToClipboard","MoreVertOutlinedIcon","VerifiedUserOutlinedIcon","LazyLoadImage","axios","LoginDialog","isEmpty","commaFormatted","ReportDialog","usePrevious","value","ref","current","DetailPage","props","history","item","setItem","useState","nid","setNid","isOpen","setIsOpen","showModalLogin","setShowModalLogin","showModalReport","setShowModalReport","photoIndex","setPhotoIndex","anchorEl","setAnchorEl","prevNid","match","params","state","location","undefined","response","post","type","key_word","offset","headers","process","env","REACT_APP_AUTHORIZATION","data","result","console","log","datas","resetScroll","window","scrollTo","handleClose","name_surname","title","transfer_amount","transfer_date","format","detail","cursor","user","info","position","hideProgressBar","autoClose","e","currentTarget","images","map","index","margin","textAlign","url","length","Boolean","id","mapStateToProps","ownProps","app","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useLayoutEffect, useRef } from \"react\";\nimport { connect } from 'react-redux'\nimport { useHistory } from \"react-router-dom\";\nimport { toast } from 'react-toastify';\nimport Lightbox from \"react-image-lightbox\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\nimport moment from \"moment\";\nimport { CircularProgress } from '@material-ui/core';\nimport {CopyToClipboard} from 'react-copy-to-clipboard';\nimport MoreVertOutlinedIcon from '@material-ui/icons/MoreVertOutlined';\nimport VerifiedUserOutlinedIcon from '@material-ui/icons/VerifiedUserOutlined';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport axios from 'axios';\n\nimport LoginDialog from './LoginDialog'\nimport { isEmpty, commaFormatted } from \"../utils\";\nimport ReportDialog from './ReportDialog'\n\n// Hook\nfunction usePrevious(value) {\n    // The ref object is a generic container whose current property is mutable ...\n    // ... and can hold any value, similar to an instance property on a class\n    const ref = useRef();\n    \n    // Store current value in ref\n    useEffect(() => {\n      ref.current = value;\n    }, [value]); // Only re-run if value changes\n    \n    // Return previous value (happens before update in useEffect above)\n    return ref.current;\n}\n\nconst DetailPage = (props) => {\n    const history = useHistory();\n\n    const [item, setItem]               = React.useState(null);\n    const [nid, setNid]                 = React.useState(0);\n    const [isOpen, setIsOpen]           = React.useState(false);\n    const [showModalLogin, setShowModalLogin]   = React.useState(false);\n    const [showModalReport, setShowModalReport] = React.useState(false);\n    const [photoIndex, setPhotoIndex]   = React.useState(0);\n    const [anchorEl, setAnchorEl]       = React.useState(null);\n\n    const prevNid = usePrevious(props.match.params.nid);\n\n    useEffect( async() => {\n        let {state} = props.location\n        let {match}  = props\n\n        setNid(match.params.nid)\n\n        if(state === undefined){\n\n            let response =  await axios.post(`/api/v1/search`, { \n                type: 2,\n                key_word: props.match.params.nid,\n                offset: 0,\n             }, { headers: {'Authorization': `Basic ${process.env.REACT_APP_AUTHORIZATION}`} });\n\n            response = response.data\n  \n            if(response.result){\n                console.log(\"/api/v1/search : response =\", response)\n\n                let {datas} = response\n                if(!isEmpty(datas)){\n                    setItem(datas[0])\n                }\n            }\n        }else{\n            setItem(state.item)\n\n            console.log('state.item :', state.item, props.history)\n        }\n\n        resetScroll()\n    }, [props.location]);\n\n    const resetScroll = () =>{\n        if(nid !== prevNid){\n            window.scrollTo(0, 0)\n        } \n    }\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    }\n\n    return (\n        <div>\n            { showModalReport && <ReportDialog showModal={showModalReport} onClose = {()=>{  setShowModalReport(false) }}  /> }\n            {\n                isEmpty(item)\n                ?   <div> <CircularProgress /> </div> \n                :   <div>\n                        <div>\n                            <div>ชื่อ-นามสกุล :</div>\n                            <div>{item.name_surname}</div>\n                        </div>\n                        <div>\n                            <div>สินค้า/ประเภท :</div>\n                            <div>{item.title}</div>\n                        </div>\n                        <div>\n                            <div>ยอดเงิน :</div>\n                            <div>{!isEmpty(item.transfer_amount) ? commaFormatted(item.transfer_amount) : item.transfer_amount}</div>\n                        </div>\n                        <div>\n                          <div>วันโอนเงิน: {moment(item.transfer_date).format('MMM DD, YYYY')}</div>\n                        </div>\n\n                        <div>\n                            <div>รายละเอียดเพิ่มเติม :</div>\n                            <div>{item.detail}</div>\n                        </div>\n                        <div>\n                            <VerifiedUserOutlinedIcon \n                                style={{cursor:'pointer'}}\n                                onClick={()=>{ \n                                    if(isEmpty(props.user)){\n                                        setShowModalLogin(true)\n                                    }else{\n                                        toast.info(\"Follow up or Unfollow up\", \n                                            {\n                                                position: \"bottom-right\", \n                                                hideProgressBar: true,\n                                                autoClose: 1000,\n                                            }) \n                                    }\n                                }} />\n                            <MoreVertOutlinedIcon \n                                style={{cursor:'pointer'}}\n                                onClick={(e)=>{\n                                    setAnchorEl(e.currentTarget);\n                                }} />\n                        </div>\n                        <div className=\"row d-flex flex-row py-5\"> \n                            {\n                                !isEmpty(item.images) &&  item.images[0].map((item, index)=>{\n                                                                                    return <div key={index} style={{margin: 10, cursor:'pointer'}} onClick={()=>{ setIsOpen(true); setPhotoIndex(index); }}>  \n                                                                                                <LazyLoadImage\n                                                                                                    className=\"lazy-load-image\"\n                                                                                                    alt={'image.alt'}\n                                                                                                    width=\"250px\"\n                                                                                                    height=\"250px\"\n                                                                                                    effect=\"blur\"\n                                                                                                    // placeholderSrc={'<div className=\"abc\">' + previewIcon + '<div>'}\n                                                                                                    placeholder={<div style={{textAlign:'center'}}><p>loading...</p></div>}\n                                                                                                    src={item.url} />\n                                                                                            </div>\n                                                                                })\n                            }\n                            \n                        </div>\n                        {\n                            isOpen &&  !isEmpty(item.images) &&   <Lightbox\n                                        mainSrc={item.images[0][photoIndex].url}\n                                        nextSrc={item.images[0][(photoIndex + 1) % item.images[0].length].url}\n                                        prevSrc={item.images[0][(photoIndex + item.images[0].length - 1) % item.images[0].length].url}\n\n                                        imageTitle= { (photoIndex + 1) + \"/\" + item.images[0].length }\n                                        // mainSrcThumbnail={images[photoIndex]}\n                                        // nextSrcThumbnail={images[(photoIndex + 1) % images.length]}\n                                        // prevSrcThumbnail={images[(photoIndex + images.length - 1) % images.length]}\n\n                                        onCloseRequest={() => setIsOpen(false) }\n\n                                        onMovePrevRequest={() =>\n                                        // this.setState({\n                                        //     photoIndex: (photoIndex + images.length - 1) % images.length\n                                        // })\n                                            setPhotoIndex((photoIndex + item.images[0].length - 1) % item.images[0].length)\n                                        }\n                                        onMoveNextRequest={() =>\n                                        // this.setState({\n                                        //     photoIndex: (photoIndex + 1) % images.length\n                                        // })\n                                            setPhotoIndex((photoIndex + 1) % item.images[0].length)\n                                        }\n                                    />\n                        }\n                        <Menu\n                            keepMounted\n                            anchorEl={anchorEl}\n                            onClose={handleClose}\n                            open={Boolean(anchorEl)}>\n                            <CopyToClipboard text={\"http://localhost:8099/detail/\" + item.id}>\n                            <MenuItem onClick={()=>{\n                                toast.info(\"Link to post copied to clipboard.\", \n                                        {\n                                            position: \"bottom-right\", \n                                            hideProgressBar: true,\n                                            autoClose: 1000,\n                                        }) \n\n                                handleClose()\n                            }}>Copy link</MenuItem>\n                            </CopyToClipboard>\n                            <MenuItem onClick={()=>{\n\n                                if(isEmpty(props.user)){\n                                    setShowModalLogin(true)\n                                }else{\n                                    setShowModalReport(true)\n                                }\n\n                                handleClose()\n                            }}>Report</MenuItem>\n                        </Menu> \n\n                        { showModalLogin &&  <LoginDialog showModal={showModalLogin} onClose = {()=>{ setShowModalLogin(false) }} />}\n\n                    </div> \n            }\n        </div>\n    );\n};\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n      user: state.user.data,\n      data: state.app.data,\n    };\n}\n  \nconst mapDispatchToProps = {\n    // fetchData,\n}\n  \nexport default connect(mapStateToProps, mapDispatchToProps)(DetailPage)"]},"metadata":{},"sourceType":"module"}