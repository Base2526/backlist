{"ast":null,"code":"var _jsxFileName = \"/app/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { BrowserRouter as BR, Route, Switch } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport { ToastContainer, toast } from 'react-toastify';\nimport LoadingOverlay from 'react-loading-overlay';\nimport io from 'socket.io-client';\nimport { CacheSwitch, CacheRoute } from \"react-router-cache-route\";\nimport axios from 'axios';\nimport { Base64 } from 'js-base64';\nimport ls from 'local-storage';\nimport Ajv from \"ajv\";\nimport Breadcrumbs from './pages/Breadcrumbs';\nimport HeaderBar from './pages/HeaderBar';\nimport Footer from './pages/Footer';\nimport routes from \"./routes\";\nimport ScrollToTopBtn from \"./components/ScrollToTopBtn\";\nimport { userLogin, userLogout } from './actions/user';\nimport { addMyApp, updateMyApp, deleteMyApp } from './actions/my_apps';\nimport { onMyFollowALL, onMyFollowUpdateStatus } from './actions/my_follows';\nimport { onConnect, onDisconnect } from './actions/socket';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _ = require('lodash');\n\nlet socket = undefined;\nlet interval = undefined;\n\nconst App = props => {\n  _s();\n\n  const [timeInterval, setTimeInterval] = React.useState(undefined); // useEffect(() => {\n  //   socketid()\n  //   console.log('socketid()')\n  // }, []);\n\n  useEffect(() => {\n    console.log('socketid() > [props.user] #0 > ', props.user, socket);\n\n    if (_.isEmpty(socket)) {\n      console.log('socketid() > socket.auth.token : #1');\n      socketid();\n    } else {\n      console.log('socketid() > socket.auth.token : #2');\n\n      if (_.isEmpty(props.user)) {\n        if (!_.isEmpty(socket.query.auth_token)) {\n          if (socket.query.auth_token !== 0) {\n            console.log('socketid() > socket.auth.token : #3');\n            socket.query.auth_token = 0;\n            socket.disconnect().connect();\n            console.log('------------- disconnect ------------- #1');\n          }\n        }\n      } else {\n        if (socket.query.auth_token !== props.user.uid) {\n          console.log('socketid() > socket.auth.token : #4');\n          socket.query.auth_token = props.user.uid;\n          socket.disconnect().connect();\n          console.log('------------- disconnect ------------- #2');\n        }\n      }\n    }\n  }, [props.user]);\n  useEffect(async () => {\n    if (interval !== undefined) {\n      clearInterval(interval);\n    }\n\n    console.log('useEffect [props.my_follows] #1: ');\n    let {\n      user,\n      my_follows\n    } = props;\n    console.log(\"useEffect [props.my_follows] #2:\", user, _.isEmpty(user), props);\n\n    if (!_.isEmpty(user)) {\n      let filter_follow_ups = my_follows.filter(im => im.local);\n      console.log(\"useEffect [props.my_follows] #3:\", filter_follow_ups);\n\n      if (!_.isEmpty(filter_follow_ups)) {\n        // setTimeInterval(setInterval(async(props)=>{\n        //   let {user, my_follows} = props\n        //   let response =  await axios.post(`/v1/syc_local`, \n        //                                   { \n        //                                     uid: user.uid, my_follows: JSON.stringify(my_follows) \n        //                                   }, \n        //                                   { headers: {'Authorization': `Basic ${ls.get('basic_auth')}` } });\n        //   response = response.data\n        //   console.log(\"useEffect [props.my_follows] #4:\", response)\n        //   if(response.result){\n        //     props.onMyFollowUpdateStatus({})\n        //   }\n        //   clearInterval(timeInterval)\n        // }, 30000, props))\n        interval = setInterval(async props => {\n          let {\n            user,\n            my_follows\n          } = props;\n          let response = await axios.post(`/api/v1/syc_local`, {\n            uid: user.uid,\n            my_follows: JSON.stringify(my_follows)\n          }, {\n            headers: {\n              'Authorization': `Basic ${ls.get('basic_auth')}`\n            }\n          });\n          response = response.data;\n          console.log(\"useEffect [props.my_follows] #4:\", response);\n\n          if (response.result) {\n            props.onMyFollowUpdateStatus({});\n          }\n\n          clearInterval(interval);\n        }, 15000, props);\n      } else {\n        console.log(\"useEffect [props.my_follows] #5:\");\n      }\n    } else {\n      console.log(\"useEffect [props.my_follows] #6:\");\n    }\n  }, [props.my_follows]);\n\n  const geolocation = async () => {\n    const res = await axios.get(process.env.REACT_APP_GEOLOCATION);\n    let data = {};\n\n    if (res.status === 200) {\n      data = res.data;\n    }\n\n    return data;\n  };\n\n  const socketid = async () => {\n    console.log('process.env :', process.env, ', props : ', props, ', geolocation : ', await geolocation());\n    /*\n    \n    {\n      extraHeaders: {\n        Authorization: \"Bearer authorization_token_here\"\n      }\n    }\n    */\n\n    if (_.isEmpty(socket)) {\n      socket = io(\"/\", // { headers:  {'Authorization': `Basic ${process.env.REACT_APP_AUTHORIZATION}`} },\n      // {\n      //   auth: {\n      //     token: \"abcd\"\n      //   }\n      // },\n      {\n        // path: '/mysocket',\n        query: {\n          \"platform\": process.env.REACT_APP_PLATFORM,\n          // \"unique_id\": _uniqueId(props),\n          \"version\": process.env.REACT_APP_VERSIONS,\n          \"geolocation\": JSON.stringify(await geolocation()),\n          auth_token: _.isEmpty(props.user) ? 0 : props.user.uid\n        } // auth: {\n        //   token: _.isEmpty(props.user) ? 0 : props.user.uid\n        // }\n\n      }, // {\n      //   auth: {\n      //     token: \"123\"\n      //   },\n      //   query: {\n      //     \"unique_id\": \"my-value\"\n      //   }\n      // },\n      // { query:{ `platform=${process.env.REACT_APP_PLATFORM}&unique_id=3434&version=${process.env.REACT_APP_VERSIONS}` }}, \n      {\n        transports: [\"websocket\"]\n      });\n    } else {\n      socket.auth.token = _.isEmpty(props.user) ? 0 : props.user.uid;\n      socket.disconnect().connect();\n      console.log('------------- disconnect ------------- #3');\n    }\n\n    if (socket.connected === false && socket.connecting === false) {\n      // use a connect() or reconnect() here if you want\n      socket.connect();\n      console.log('reconnected!');\n      socket.off('connect', onConnect);\n      socket.off(\"uniqueID\", onUniqueID);\n      socket.off('disconnect', onDisconnect);\n      socket.off('onUser', onUser);\n      socket.off('onProfile', onProfile);\n      socket.off('onContent', onContent);\n      socket.off('onMyFollows', onMyFollows); // กรณีมีคนมากด follow content เรา\n\n      socket.off('onAppFollowUp', onAppFollowUp);\n      socket.off('test', test);\n      socket.off('onAppFollowers', onAppFollowers);\n    } else {\n      console.log('socket :', socket);\n    }\n\n    socket.on('connect', onConnect);\n    socket.on(\"uniqueID\", onUniqueID);\n    socket.on('disconnect', onDisconnect);\n    socket.on('onUser', onUser);\n    socket.on('onProfile', onProfile);\n    socket.on('onContent', onContent);\n    socket.on('onMyFollows', onMyFollows); // กรณีมีคนมากด follow content เรา\n\n    socket.on('onAppFollowUp', onAppFollowUp);\n    socket.on('connect_error', handleErrors);\n    socket.on('connect_failed', handleErrors);\n    socket.on('test', test);\n    socket.off('onAppFollowers', onAppFollowers);\n  };\n\n  const test = data => {\n    console.log(\"test :\", data);\n  };\n\n  const handleErrors = err => {\n    console.log('connect_error + connect_failed', err);\n  };\n\n  const onConnect = () => {\n    console.log('Socket io, connent! : ', socket);\n    props.onConnect({\n      connected: socket.connected\n    });\n  };\n\n  const onDisconnect = () => {\n    console.log('Socket io, disconnect! : ', socket);\n    props.onDisconnect();\n  };\n\n  const onUniqueID = data => {// console.log(\"unique_id :\", data)\n    // ls.set('socketIO', JSON.stringify(data))\n    // var socketIO = ls.get('socketIO')\n    // console.log(\"socketIO :\", socketIO)\n  };\n\n  const onUser = data => {\n    console.log(\"onUser :\", data);\n\n    try {\n      let mode = data.mode;\n      console.log(\"onUser mode\", mode);\n\n      switch (mode) {\n        case 'delete':\n          {\n            socket.disconnect();\n            console.log('------------- disconnect ------------- #4');\n            ls.remove('basic_auth');\n            ls.remove('session');\n            props.userLogout();\n            console.log(\"onUser ok\");\n            break;\n          }\n      }\n    } catch (error) {\n      // Catch internal functions, variables and return (jsx) errors.\n      // You can also create a lib to log the error to an error reporting service\n      // and use it here.\n      console.log(\"onUser error :\", error);\n    } // mode: \"delete\"\n\n  };\n\n  const onProfile = data => {\n    props.userLogin(data);\n  };\n\n  const onContent = data => {\n    console.log(\"onContent :\", data); // mode: \"edit\", nid: \"104\"}\n\n    try {\n      let mode = data.mode;\n      console.log(\"onContent mode\", mode);\n\n      switch (mode) {\n        case 'add':\n          {\n            console.log(\"onContent add\");\n            props.addMyApp(data);\n            break;\n          }\n\n        case 'edit':\n          {\n            console.log(\"onContent edit\");\n            props.updateMyApp(data);\n            break;\n          }\n\n        case 'delete':\n          {\n            console.log(\"onContent delete\");\n            props.deleteMyApp(data);\n            break;\n          }\n      }\n    } catch (error) {\n      // Catch internal functions, variables and return (jsx) errors.\n      // You can also create a lib to log the error to an error reporting service\n      // and use it here.\n      console.log(\"onContent error :\", error);\n    }\n  };\n\n  const onMyFollows = data => {\n    try {\n      console.log(\"MY_FOLLOW_ALL : \", data);\n      props.onMyFollowALL(data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const onAppFollowUp = data => {\n    console.log(\"onAppFollowUp : \", data); // props.onMyFollowALL(data)\n  };\n\n  return /*#__PURE__*/_jsxDEV(BR, {\n    children: /*#__PURE__*/_jsxDEV(LoadingOverlay, {\n      active: props.is_loading_overlay,\n      spinner: true,\n      text: \"Wait...\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App\",\n        children: [/*#__PURE__*/_jsxDEV(HeaderBar, { ...props\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(Container, {\n          children: [/*#__PURE__*/_jsxDEV(ToastContainer, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(CacheSwitch, {\n            children: routes.map(({\n              path,\n              name,\n              Component\n            }, key) => /*#__PURE__*/_jsxDEV(CacheRoute, {\n              exact: true,\n              path: path,\n              render: props => {\n                const crumbs = routes // Get all routes that contain the current one.\n                .filter(({\n                  path\n                }) => props.match.path.includes(path)) // Swap out any dynamic routes with their param values.\n                // E.g. \"/pizza/:pizzaId\" will become \"/pizza/1\"\n                .map(({\n                  path,\n                  ...rest\n                }) => ({\n                  path: Object.keys(props.match.params).length ? Object.keys(props.match.params).reduce((path, param) => path.replace(`:${param}`, props.match.params[param]), path) : path,\n                  ...rest\n                })); // if(this.props.logged_in){\n                //   connect_socketIO(this.props)\n                // }\n                // console.log();\n\n                console.log(`Generated crumbs for ${props.match.path}`);\n                crumbs.map(({\n                  name,\n                  path\n                }) => console.log({\n                  name,\n                  path\n                }));\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"p-8\",\n                  children: [/*#__PURE__*/_jsxDEV(Breadcrumbs, {\n                    crumbs: crumbs\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 399,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(Component, { ...props\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 400,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(ScrollToTopBtn, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 402,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 398,\n                  columnNumber: 29\n                }, this);\n              }\n            }, key, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 23\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 358,\n    columnNumber: 11\n  }, this);\n};\n\n_s(App, \"dhp762aByYjLtHdX9u5kIODbPT0=\");\n\n_c = App;\n\nconst mapStateToProps = (state, ownProps) => {\n  // console.log('state : >>> ', state)\n  return {\n    user: state.user.data,\n    my_apps: state.my_apps.data,\n    follow_ups: state.user.follow_ups,\n    my_follows: state.my_follows.data,\n    is_loading_overlay: state.user.is_loading_overlay\n  };\n};\n\nconst mapDispatchToProps = {\n  userLogin,\n  userLogout,\n  addMyApp,\n  updateMyApp,\n  deleteMyApp,\n  onMyFollowALL,\n  onMyFollowUpdateStatus,\n  onConnect,\n  onDisconnect\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/app/src/App.js"],"names":["React","useEffect","connect","BrowserRouter","BR","Route","Switch","Container","ToastContainer","toast","LoadingOverlay","io","CacheSwitch","CacheRoute","axios","Base64","ls","Ajv","Breadcrumbs","HeaderBar","Footer","routes","ScrollToTopBtn","userLogin","userLogout","addMyApp","updateMyApp","deleteMyApp","onMyFollowALL","onMyFollowUpdateStatus","onConnect","onDisconnect","_","require","socket","undefined","interval","App","props","timeInterval","setTimeInterval","useState","console","log","user","isEmpty","socketid","query","auth_token","disconnect","uid","clearInterval","my_follows","filter_follow_ups","filter","im","local","setInterval","response","post","JSON","stringify","headers","get","data","result","geolocation","res","process","env","REACT_APP_GEOLOCATION","status","REACT_APP_PLATFORM","REACT_APP_VERSIONS","transports","auth","token","connected","connecting","off","onUniqueID","onUser","onProfile","onContent","onMyFollows","onAppFollowUp","test","onAppFollowers","on","handleErrors","err","mode","remove","error","is_loading_overlay","map","path","name","Component","key","crumbs","match","includes","rest","Object","keys","params","length","reduce","param","replace","mapStateToProps","state","ownProps","my_apps","follow_ups","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { connect } from 'react-redux'\nimport { BrowserRouter as BR, Route, Switch } from 'react-router-dom'; \nimport Container from 'react-bootstrap/Container'\nimport { ToastContainer, toast } from 'react-toastify';\nimport LoadingOverlay from 'react-loading-overlay';\nimport io from 'socket.io-client';\nimport { CacheSwitch, CacheRoute, } from \"react-router-cache-route\";\nimport axios from 'axios';\nimport { Base64 } from 'js-base64';\n\nimport ls from 'local-storage';\n\nimport Ajv from \"ajv\"\n\nimport Breadcrumbs from './pages/Breadcrumbs'\nimport HeaderBar from './pages/HeaderBar';\nimport Footer from './pages/Footer';\nimport routes from \"./routes\";\nimport ScrollToTopBtn from \"./components/ScrollToTopBtn\";\nimport { userLogin, userLogout } from './actions/user';\nimport { addMyApp, updateMyApp, deleteMyApp } from './actions/my_apps';\n\nimport { onMyFollowALL, onMyFollowUpdateStatus } from './actions/my_follows'\n\nimport { onConnect, onDisconnect } from './actions/socket'\n\nvar _ = require('lodash');\n\nlet socket = undefined;\nlet interval = undefined;\n\nconst App = (props) => {\n  const [timeInterval, setTimeInterval] = React.useState(undefined);\n\n  // useEffect(() => {\n  //   socketid()\n  //   console.log('socketid()')\n  // }, []);\n\n  useEffect(() => {\n    \n    console.log('socketid() > [props.user] #0 > ', props.user , socket )\n\n    if( _.isEmpty(socket) ){\n      console.log('socketid() > socket.auth.token : #1')\n      socketid()\n    }else{\n      console.log('socketid() > socket.auth.token : #2')\n\n      if(_.isEmpty(props.user)){\n        if(!_.isEmpty(socket.query.auth_token)){\n          if(socket.query.auth_token !== 0){\n            console.log('socketid() > socket.auth.token : #3')\n            socket.query.auth_token = 0;\n            socket.disconnect().connect()\n\n            console.log('------------- disconnect ------------- #1')\n          }\n        }\n      }else{\n        if(socket.query.auth_token !== props.user.uid){\n          console.log('socketid() > socket.auth.token : #4')\n          socket.query.auth_token = props.user.uid;\n          socket.disconnect().connect()\n\n          console.log('------------- disconnect ------------- #2')\n        }\n      }\n    }\n  }, [props.user]);\n\n  useEffect(async() => {\n    if( interval !== undefined){\n      clearInterval(interval)\n    }\n\n    console.log('useEffect [props.my_follows] #1: ')\n\n    let {user, my_follows} = props\n    console.log(\"useEffect [props.my_follows] #2:\", user, _.isEmpty(user), props)\n    if(!_.isEmpty(user)){\n      let filter_follow_ups = my_follows.filter((im)=>im.local)\n      \n      console.log(\"useEffect [props.my_follows] #3:\", filter_follow_ups)\n      if(!_.isEmpty(filter_follow_ups)){\n        // setTimeInterval(setInterval(async(props)=>{\n        //   let {user, my_follows} = props\n        //   let response =  await axios.post(`/v1/syc_local`, \n        //                                   { \n        //                                     uid: user.uid, my_follows: JSON.stringify(my_follows) \n        //                                   }, \n        //                                   { headers: {'Authorization': `Basic ${ls.get('basic_auth')}` } });\n\n        //   response = response.data\n        //   console.log(\"useEffect [props.my_follows] #4:\", response)\n\n        //   if(response.result){\n        //     props.onMyFollowUpdateStatus({})\n        //   }\n\n        //   clearInterval(timeInterval)\n        // }, 30000, props))\n\n\n        interval = setInterval(async(props)=>{\n          let {user, my_follows} = props\n          let response =  await axios.post(`/api/v1/syc_local`, \n                                          { \n                                            uid: user.uid, my_follows: JSON.stringify(my_follows) \n                                          }, \n                                          { headers: {'Authorization': `Basic ${ls.get('basic_auth')}` } });\n\n          response = response.data\n          console.log(\"useEffect [props.my_follows] #4:\", response)\n\n          if(response.result){\n            props.onMyFollowUpdateStatus({})\n          }\n\n          clearInterval(interval)\n        }, 15000, props)\n      }else {\n        console.log(\"useEffect [props.my_follows] #5:\")\n      }\n    }else{\n      console.log(\"useEffect [props.my_follows] #6:\")\n    }\n  }, [props.my_follows]);\n\n  const geolocation = async () => {\n    const res = await axios.get( process.env.REACT_APP_GEOLOCATION )\n    let data = {}\n    if(res.status === 200){\n      data = res.data\n    }\n\n    return data;\n  }\n\n  const socketid = async() =>{\n    console.log('process.env :', process.env, ', props : ', props, ', geolocation : ', await geolocation())\n\n    /*\n    \n    {\n      extraHeaders: {\n        Authorization: \"Bearer authorization_token_here\"\n      }\n    }\n    */\n\n    if(_.isEmpty(socket)){\n      socket = io( \"/\", \n        // { headers:  {'Authorization': `Basic ${process.env.REACT_APP_AUTHORIZATION}`} },\n        \n        // {\n        //   auth: {\n        //     token: \"abcd\"\n        //   }\n        // },\n        { \n          // path: '/mysocket',\n          query: {\n            \"platform\" : process.env.REACT_APP_PLATFORM, \n            // \"unique_id\": _uniqueId(props),\n            \"version\"  : process.env.REACT_APP_VERSIONS,\n            \"geolocation\" : JSON.stringify( await geolocation() ),\n            auth_token: _.isEmpty(props.user) ? 0 : props.user.uid\n          },\n\n          \n          // auth: {\n          //   token: _.isEmpty(props.user) ? 0 : props.user.uid\n          // }\n        },\n        // {\n        //   auth: {\n        //     token: \"123\"\n        //   },\n        //   query: {\n        //     \"unique_id\": \"my-value\"\n        //   }\n        // },\n        // { query:{ `platform=${process.env.REACT_APP_PLATFORM}&unique_id=3434&version=${process.env.REACT_APP_VERSIONS}` }}, \n        \n        { transports: [\"websocket\"] });\n    }else{\n      socket.auth.token = _.isEmpty(props.user) ? 0 : props.user.uid;\n      socket.disconnect().connect()\n\n      console.log('------------- disconnect ------------- #3')\n    }                 \n    \n    if (socket.connected === false && socket.connecting === false) {\n      // use a connect() or reconnect() here if you want\n      socket.connect()\n      console.log('reconnected!');\n\n      socket.off('connect', onConnect)\n      socket.off(\"uniqueID\", onUniqueID);\n      socket.off('disconnect', onDisconnect);\n\n      socket.off('onUser', onUser);\n      socket.off('onProfile', onProfile);\n      socket.off('onContent', onContent);\n\n      socket.off('onMyFollows', onMyFollows);\n\n      // กรณีมีคนมากด follow content เรา\n      socket.off('onAppFollowUp', onAppFollowUp);\n\n\n      socket.off('test', test);\n\n      socket.off('onAppFollowers', onAppFollowers)\n    }else{\n      console.log('socket :', socket)\n    }\n\n    socket.on('connect', onConnect)\n    socket.on(\"uniqueID\", onUniqueID);\n    socket.on('disconnect', onDisconnect);\n\n    socket.on('onUser', onUser);\n    socket.on('onProfile', onProfile);\n    socket.on('onContent', onContent);\n\n    socket.on('onMyFollows', onMyFollows);\n\n    // กรณีมีคนมากด follow content เรา\n    socket.on('onAppFollowUp', onAppFollowUp);\n\n    socket.on('connect_error', handleErrors);\n    socket.on('connect_failed', handleErrors);\n\n\n    socket.on('test', test);\n\n    socket.off('onAppFollowers', onAppFollowers)\n  }\n\n  const test = (data)=>{\n    console.log(\"test :\", data)\n  }\n\n  const handleErrors = (err)=>{\n    console.log('connect_error + connect_failed', err);\n  }\n\n  const onConnect = () =>{\n    console.log('Socket io, connent! : ', socket);\n\n    props.onConnect({connected: socket.connected})\n  }\n\n  const onDisconnect = () =>{\n    console.log('Socket io, disconnect! : ', socket);\n\n    props.onDisconnect()\n  }\n\n  const onUniqueID = (data) =>{\n    // console.log(\"unique_id :\", data)\n\n    // ls.set('socketIO', JSON.stringify(data))\n\n    // var socketIO = ls.get('socketIO')\n\n    // console.log(\"socketIO :\", socketIO)\n  }\n\n  const onUser = (data) =>{\n    console.log(\"onUser :\", data)\n\n    try {\n      let mode = data.mode\n      console.log(\"onUser mode\", mode)\n      switch(mode){\n        case 'delete':{\n          socket.disconnect();\n\n          console.log('------------- disconnect ------------- #4')\n\n          ls.remove('basic_auth')\n          ls.remove('session')\n          props.userLogout()\n\n          console.log(\"onUser ok\",)\n          break;\n        }\n      }\n    } catch (error) {\n      // Catch internal functions, variables and return (jsx) errors.\n      // You can also create a lib to log the error to an error reporting service\n      // and use it here.\n      console.log(\"onUser error :\", error)\n    }\n\n    // mode: \"delete\"\n  }\n\n  const onProfile = (data) =>{\n    props.userLogin(data) \n  }\n\n  const onContent = (data) =>{\n    console.log(\"onContent :\", data)\n\n    // mode: \"edit\", nid: \"104\"}\n\n    try {\n      let mode = data.mode\n      console.log(\"onContent mode\", mode)\n      switch(mode){\n        case 'add':{\n          console.log(\"onContent add\")\n          props.addMyApp(data)\n          break;\n        }\n        case 'edit':{\n          console.log(\"onContent edit\")\n          props.updateMyApp(data)\n          break;\n        }\n        case 'delete':{\n          console.log(\"onContent delete\")\n          props.deleteMyApp(data)\n          break;\n        }\n      }\n    } catch (error) {\n      // Catch internal functions, variables and return (jsx) errors.\n      // You can also create a lib to log the error to an error reporting service\n      // and use it here.\n      console.log(\"onContent error :\", error)\n    }\n  }\n\n  const onMyFollows = (data) =>{\n    try{\n      console.log(\"MY_FOLLOW_ALL : \", data)\n\n      props.onMyFollowALL(data)\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  const onAppFollowUp = (data) =>{\n    console.log(\"onAppFollowUp : \", data)\n\n    // props.onMyFollowALL(data)\n  }\n\n\n\n  return( <BR>\n            <LoadingOverlay\n              active={props.is_loading_overlay}\n              spinner\n              text='Wait...'>\n              <div className=\"App\">\n                  <HeaderBar {...props} />\n                  <Container>\n                  <ToastContainer />\n                  <CacheSwitch>\n                    {routes.map(({ path, name, Component }, key) => (\n                      <CacheRoute\n                        exact\n                        path={path}\n                        key={key}\n                        render={props => {\n                          const crumbs = routes\n                            // Get all routes that contain the current one.\n                            .filter(({ path }) => props.match.path.includes(path))\n                            // Swap out any dynamic routes with their param values.\n                            // E.g. \"/pizza/:pizzaId\" will become \"/pizza/1\"\n                            .map(({ path, ...rest }) => ({\n                              path: Object.keys(props.match.params).length\n                                ? Object.keys(props.match.params).reduce(\n                                  (path, param) => path.replace(\n                                    `:${param}`, props.match.params[param]\n                                  ), path\n                                  )\n                                : path,\n                              ...rest\n                            }));\n\n                          // if(this.props.logged_in){\n                          //   connect_socketIO(this.props)\n                          // }\n\n                          // console.log();\n                          console.log(`Generated crumbs for ${props.match.path}`);\n                          crumbs.map(({ name, path }) => console.log({ name, path }));\n                          return (\n                            <div className=\"p-8\">\n                              <Breadcrumbs crumbs={crumbs} />\n                              <Component {...props} />\n\n                              <ScrollToTopBtn />\n                              \n                            </div>\n                          );\n                        }}\n                      />\n                    ))}\n                  </CacheSwitch>\n                  </Container>\n                <Footer />  \n              </div>\n            </LoadingOverlay>\n          </BR>)\n}\n\nconst mapStateToProps = (state, ownProps) => {\n\n  // console.log('state : >>> ', state)\n\treturn {\n    user: state.user.data,\n    my_apps: state.my_apps.data,\n    follow_ups: state.user.follow_ups,\n\n    my_follows: state.my_follows.data,\n\n    is_loading_overlay: state.user.is_loading_overlay,\n  };\n}\n\nconst mapDispatchToProps = {\n  userLogin,\n  userLogout,\n\n\n  addMyApp, \n  updateMyApp, \n  deleteMyApp,\n\n  onMyFollowALL,\n  onMyFollowUpdateStatus,\n\n\n  onConnect, \n  onDisconnect \n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App)\n"]},"metadata":{},"sourceType":"module"}