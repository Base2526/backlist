{"ast":null,"code":"var _jsxFileName = \"/app/src/pages/DetailPage.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useLayoutEffect, useRef } from \"react\";\nimport { connect } from 'react-redux';\nimport { useHistory } from \"react-router-dom\";\nimport { toast } from 'react-toastify';\nimport Lightbox from \"react-image-lightbox\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\nimport moment from \"moment\";\nimport { CircularProgress } from '@material-ui/core';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport MoreVertOutlinedIcon from '@material-ui/icons/MoreVertOutlined';\nimport VerifiedUserOutlinedIcon from '@material-ui/icons/VerifiedUserOutlined';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport axios from 'axios';\nimport LoginDialog from './LoginDialog';\nimport { isEmpty, commaFormatted } from \"../utils\";\nimport ReportDialog from './ReportDialog';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _ = require('lodash'); // Hook\n\n\nfunction usePrevious(value) {\n  _s();\n\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef(); // Store current value in ref\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n  // Return previous value (happens before update in useEffect above)\n\n  return ref.current;\n}\n\n_s(usePrevious, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n\nconst DetailPage = props => {\n  _s2();\n\n  const history = useHistory();\n  const [item, setItem] = React.useState(null);\n  const [nid, setNid] = React.useState(0);\n  const [isOpen, setIsOpen] = React.useState(false);\n  const [showModalLogin, setShowModalLogin] = React.useState(false);\n  const [showModalReport, setShowModalReport] = React.useState(false);\n  const [photoIndex, setPhotoIndex] = React.useState(0);\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const prevNid = usePrevious(props.match.params.nid);\n  useEffect(async () => {\n    let {\n      state\n    } = props.location;\n    let {\n      match\n    } = props;\n    setNid(match.params.nid); // _.isEmpty( (props.my_follows.find((el)=>el.nid === nid && el.status)) )\n    // let __x = _.isEmpty( (props.my_follows.find((el)=>el.nid === parseInt(match.params.nid) && el.status)) );\n    // let __y = props.my_follows;\n    // let __z = props.my_follows.find((el)=>el.nid === parseInt(match.params.nid) && el.status )\n    // console.log(\"__x , __y, __z =\", __x, __y, __z, match.params.nid)\n\n    if (state === undefined) {\n      let response = await axios.post(`/api/v1/search`, {\n        type: 2,\n        key_word: props.match.params.nid,\n        offset: 0\n      }, {\n        headers: {\n          'Authorization': `Basic ${process.env.REACT_APP_AUTHORIZATION}`\n        }\n      });\n      response = response.data;\n\n      if (response.result) {\n        console.log(\"/api/v1/search : response =\", response);\n        let {\n          datas\n        } = response;\n\n        if (!isEmpty(datas)) {\n          if (_.isEmpty(datas[0])) {\n            props.history.goBack();\n            return;\n          }\n\n          setItem(datas[0]);\n        }\n      }\n    } else {\n      if (_.isEmpty(state.item)) {\n        props.history.goBack();\n        return;\n      }\n\n      setItem(state.item);\n    }\n\n    resetScroll();\n  }, [props.location]);\n\n  const resetScroll = () => {\n    if (nid !== prevNid) {\n      window.scrollTo(0, 0);\n    }\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [showModalReport && /*#__PURE__*/_jsxDEV(ReportDialog, {\n      showModal: showModalReport,\n      onClose: () => {\n        setShowModalReport(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 34\n    }, this), isEmpty(item) ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\" \", /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 27\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D-\\u0E19\\u0E32\\u0E21\\u0E2A\\u0E01\\u0E38\\u0E25 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.name_surname\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32/\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E22\\u0E2D\\u0E14\\u0E40\\u0E07\\u0E34\\u0E19 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: !isEmpty(item.transfer_amount) ? commaFormatted(item.transfer_amount) : item.transfer_amount\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"\\u0E27\\u0E31\\u0E19\\u0E42\\u0E2D\\u0E19\\u0E40\\u0E07\\u0E34\\u0E19: \", moment(item.transfer_date).format('MMM DD, YYYY')]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 27\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E15\\u0E34\\u0E21 :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.detail\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(VerifiedUserOutlinedIcon // style={{cursor:'pointer', color:\"red\"}}\n        // setFollowUp( isEmpty(props.my_follows.find((el)=>el.nid === nid && el.status)) ? false : true )\n        , {\n          style: {\n            fill: _.isEmpty(props.my_follows.find(el => el.nid === parseInt(nid) && el.status)) ? \"gray\" : \"red\"\n          },\n          onClick: () => {// if(isEmpty(props.user)){\n            //     setShowModalLogin(true)\n            // }else{\n            //     toast.info(\"Follow up or Unfollow up\", \n            //         {\n            //             position: \"bottom-right\", \n            //             hideProgressBar: true,\n            //             autoClose: 1000,\n            //         }) \n            // }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(MoreVertOutlinedIcon, {\n          style: {\n            cursor: 'pointer'\n          },\n          onClick: e => {\n            setAnchorEl(e.currentTarget);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row d-flex flex-row py-5\",\n        children: !isEmpty(item.images) && item.images[0].map((item, index) => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              margin: 10,\n              cursor: 'pointer'\n            },\n            onClick: () => {\n              setIsOpen(true);\n              setPhotoIndex(index);\n            },\n            children: /*#__PURE__*/_jsxDEV(LazyLoadImage, {\n              className: \"lazy-load-image\",\n              alt: 'image.alt',\n              width: \"250px\",\n              height: \"250px\",\n              effect: \"blur\" // placeholderSrc={'<div className=\"abc\">' + previewIcon + '<div>'}\n              ,\n              placeholder: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  textAlign: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"loading...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 169,\n                  columnNumber: 148\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 114\n              }, this),\n              src: item.url\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 97\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 92\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 25\n      }, this), isOpen && !isEmpty(item.images) && /*#__PURE__*/_jsxDEV(Lightbox, {\n        mainSrc: item.images[0][photoIndex].url,\n        nextSrc: item.images[0][(photoIndex + 1) % item.images[0].length].url,\n        prevSrc: item.images[0][(photoIndex + item.images[0].length - 1) % item.images[0].length].url,\n        imageTitle: photoIndex + 1 + \"/\" + item.images[0].length // mainSrcThumbnail={images[photoIndex]}\n        // nextSrcThumbnail={images[(photoIndex + 1) % images.length]}\n        // prevSrcThumbnail={images[(photoIndex + images.length - 1) % images.length]}\n        ,\n        onCloseRequest: () => setIsOpen(false),\n        onMovePrevRequest: () => // this.setState({\n        //     photoIndex: (photoIndex + images.length - 1) % images.length\n        // })\n        setPhotoIndex((photoIndex + item.images[0].length - 1) % item.images[0].length),\n        onMoveNextRequest: () => // this.setState({\n        //     photoIndex: (photoIndex + 1) % images.length\n        // })\n        setPhotoIndex((photoIndex + 1) % item.images[0].length)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 67\n      }, this), /*#__PURE__*/_jsxDEV(Menu, {\n        keepMounted: true,\n        anchorEl: anchorEl,\n        onClose: handleClose,\n        open: Boolean(anchorEl),\n        children: [/*#__PURE__*/_jsxDEV(CopyToClipboard, {\n          text: \"http://localhost:8099/detail/\" + item.id,\n          children: /*#__PURE__*/_jsxDEV(MenuItem, {\n            onClick: () => {\n              toast.info(\"Link to post copied to clipboard.\", {\n                position: \"bottom-right\",\n                hideProgressBar: true,\n                autoClose: 1000\n              });\n              handleClose();\n            },\n            children: \"Copy link\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n          onClick: () => {\n            if (isEmpty(props.user)) {\n              setShowModalLogin(true);\n            } else {\n              setShowModalReport(true);\n            }\n\n            handleClose();\n          },\n          children: \"Report\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 25\n      }, this), showModalLogin && /*#__PURE__*/_jsxDEV(LoginDialog, {\n        showModal: showModalLogin,\n        onClose: () => {\n          setShowModalLogin(false);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 46\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 21\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(DetailPage, \"N4RFV9GRPs9yIi1GQXBNsTgujG8=\", false, function () {\n  return [useHistory, usePrevious];\n});\n\n_c = DetailPage;\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    user: state.user.data,\n    data: state.app.data,\n    my_follows: state.my_follows.data\n  };\n};\n\nconst mapDispatchToProps = {// fetchData,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(DetailPage);\n\nvar _c;\n\n$RefreshReg$(_c, \"DetailPage\");","map":{"version":3,"sources":["/app/src/pages/DetailPage.js"],"names":["React","useEffect","useLayoutEffect","useRef","connect","useHistory","toast","Lightbox","MenuItem","Menu","moment","CircularProgress","CopyToClipboard","MoreVertOutlinedIcon","VerifiedUserOutlinedIcon","LazyLoadImage","axios","LoginDialog","isEmpty","commaFormatted","ReportDialog","_","require","usePrevious","value","ref","current","DetailPage","props","history","item","setItem","useState","nid","setNid","isOpen","setIsOpen","showModalLogin","setShowModalLogin","showModalReport","setShowModalReport","photoIndex","setPhotoIndex","anchorEl","setAnchorEl","prevNid","match","params","state","location","undefined","response","post","type","key_word","offset","headers","process","env","REACT_APP_AUTHORIZATION","data","result","console","log","datas","goBack","resetScroll","window","scrollTo","handleClose","name_surname","title","transfer_amount","transfer_date","format","detail","fill","my_follows","find","el","parseInt","status","cursor","e","currentTarget","images","map","index","margin","textAlign","url","length","Boolean","id","info","position","hideProgressBar","autoClose","user","mapStateToProps","ownProps","app","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useLayoutEffect, useRef } from \"react\";\nimport { connect } from 'react-redux'\nimport { useHistory } from \"react-router-dom\";\nimport { toast } from 'react-toastify';\nimport Lightbox from \"react-image-lightbox\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\nimport moment from \"moment\";\nimport { CircularProgress } from '@material-ui/core';\nimport {CopyToClipboard} from 'react-copy-to-clipboard';\nimport MoreVertOutlinedIcon from '@material-ui/icons/MoreVertOutlined';\nimport VerifiedUserOutlinedIcon from '@material-ui/icons/VerifiedUserOutlined';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport axios from 'axios';\n\nimport LoginDialog from './LoginDialog'\nimport { isEmpty, commaFormatted } from \"../utils\";\nimport ReportDialog from './ReportDialog'\n\nvar _ = require('lodash');\n\n// Hook\nfunction usePrevious(value) {\n    // The ref object is a generic container whose current property is mutable ...\n    // ... and can hold any value, similar to an instance property on a class\n    const ref = useRef();\n    \n    // Store current value in ref\n    useEffect(() => {\n      ref.current = value;\n    }, [value]); // Only re-run if value changes\n    \n    // Return previous value (happens before update in useEffect above)\n    return ref.current;\n}\n\nconst DetailPage = (props) => {\n    const history = useHistory();\n\n    const [item, setItem]               = React.useState(null);\n    const [nid, setNid]                 = React.useState(0);\n    const [isOpen, setIsOpen]           = React.useState(false);\n    const [showModalLogin, setShowModalLogin]   = React.useState(false);\n    const [showModalReport, setShowModalReport] = React.useState(false);\n    const [photoIndex, setPhotoIndex]   = React.useState(0);\n    const [anchorEl, setAnchorEl]       = React.useState(null);\n\n    const prevNid = usePrevious(props.match.params.nid);\n\n    useEffect( async() => {\n        let {state} = props.location\n        let {match}  = props\n\n        setNid(match.params.nid)\n\n        // _.isEmpty( (props.my_follows.find((el)=>el.nid === nid && el.status)) )\n        // let __x = _.isEmpty( (props.my_follows.find((el)=>el.nid === parseInt(match.params.nid) && el.status)) );\n        // let __y = props.my_follows;\n        // let __z = props.my_follows.find((el)=>el.nid === parseInt(match.params.nid) && el.status )\n        // console.log(\"__x , __y, __z =\", __x, __y, __z, match.params.nid)\n\n        if(state === undefined){\n\n            let response =  await axios.post(`/api/v1/search`, { \n                type: 2,\n                key_word: props.match.params.nid,\n                offset: 0,\n             }, { headers: {'Authorization': `Basic ${process.env.REACT_APP_AUTHORIZATION}`} });\n\n            response = response.data\n  \n            if(response.result){\n                console.log(\"/api/v1/search : response =\", response)\n\n                let {datas} = response\n                if(!isEmpty(datas)){\n                    if(_.isEmpty(datas[0])){\n                        props.history.goBack();\n                        return;\n                    }\n\n                    setItem(datas[0])\n                }\n            }\n        }else{\n\n            if(_.isEmpty(state.item)){\n                props.history.goBack();\n                return;\n            }\n\n            setItem(state.item)\n        }\n\n        resetScroll()\n    }, [props.location]);\n\n    const resetScroll = () =>{\n        if(nid !== prevNid){\n            window.scrollTo(0, 0)\n        } \n    }\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    }\n\n    return (\n        <div>\n            { showModalReport && <ReportDialog showModal={showModalReport} onClose = {()=>{  setShowModalReport(false) }}  /> }\n            {\n                isEmpty(item)\n                ?   <div> <CircularProgress /> </div> \n                :   <div>\n                        <div>\n                            <div>ชื่อ-นามสกุล :</div>\n                            <div>{item.name_surname}</div>\n                        </div>\n                        <div>\n                            <div>สินค้า/ประเภท :</div>\n                            <div>{item.title}</div>\n                        </div>\n                        <div>\n                            <div>ยอดเงิน :</div>\n                            <div>{!isEmpty(item.transfer_amount) ? commaFormatted(item.transfer_amount) : item.transfer_amount}</div>\n                        </div>\n                        <div>\n                          <div>วันโอนเงิน: {moment(item.transfer_date).format('MMM DD, YYYY')}</div>\n                        </div>\n\n                        <div>\n                            <div>รายละเอียดเพิ่มเติม :</div>\n                            <div>{item.detail}</div>\n                        </div>\n                        <div>\n                            <VerifiedUserOutlinedIcon \n                                // style={{cursor:'pointer', color:\"red\"}}\n                                // setFollowUp( isEmpty(props.my_follows.find((el)=>el.nid === nid && el.status)) ? false : true )\n                                style={{fill: _.isEmpty( (props.my_follows.find((el)=>el.nid === parseInt(nid) && el.status)) ) ? \"gray\" : \"red\"}}\n                                onClick={()=>{ \n                                    // if(isEmpty(props.user)){\n                                    //     setShowModalLogin(true)\n                                    // }else{\n                                    //     toast.info(\"Follow up or Unfollow up\", \n                                    //         {\n                                    //             position: \"bottom-right\", \n                                    //             hideProgressBar: true,\n                                    //             autoClose: 1000,\n                                    //         }) \n                                    // }\n                                }} />\n                            <MoreVertOutlinedIcon \n                                style={{cursor:'pointer'}}\n                                onClick={(e)=>{\n                                    setAnchorEl(e.currentTarget);\n                                }} />\n                        </div>\n                        <div className=\"row d-flex flex-row py-5\"> \n                            {\n                                !isEmpty(item.images) &&  item.images[0].map((item, index)=>{\n                                                                                    return <div key={index} style={{margin: 10, cursor:'pointer'}} onClick={()=>{ setIsOpen(true); setPhotoIndex(index); }}>  \n                                                                                                <LazyLoadImage\n                                                                                                    className=\"lazy-load-image\"\n                                                                                                    alt={'image.alt'}\n                                                                                                    width=\"250px\"\n                                                                                                    height=\"250px\"\n                                                                                                    effect=\"blur\"\n                                                                                                    // placeholderSrc={'<div className=\"abc\">' + previewIcon + '<div>'}\n                                                                                                    placeholder={<div style={{textAlign:'center'}}><p>loading...</p></div>}\n                                                                                                    src={item.url} />\n                                                                                            </div>\n                                                                                })\n                            }\n                            \n                        </div>\n                        {\n                            isOpen &&  !isEmpty(item.images) &&   <Lightbox\n                                        mainSrc={item.images[0][photoIndex].url}\n                                        nextSrc={item.images[0][(photoIndex + 1) % item.images[0].length].url}\n                                        prevSrc={item.images[0][(photoIndex + item.images[0].length - 1) % item.images[0].length].url}\n\n                                        imageTitle= { (photoIndex + 1) + \"/\" + item.images[0].length }\n                                        // mainSrcThumbnail={images[photoIndex]}\n                                        // nextSrcThumbnail={images[(photoIndex + 1) % images.length]}\n                                        // prevSrcThumbnail={images[(photoIndex + images.length - 1) % images.length]}\n\n                                        onCloseRequest={() => setIsOpen(false) }\n\n                                        onMovePrevRequest={() =>\n                                        // this.setState({\n                                        //     photoIndex: (photoIndex + images.length - 1) % images.length\n                                        // })\n                                            setPhotoIndex((photoIndex + item.images[0].length - 1) % item.images[0].length)\n                                        }\n                                        onMoveNextRequest={() =>\n                                        // this.setState({\n                                        //     photoIndex: (photoIndex + 1) % images.length\n                                        // })\n                                            setPhotoIndex((photoIndex + 1) % item.images[0].length)\n                                        }\n                                    />\n                        }\n                        <Menu\n                            keepMounted\n                            anchorEl={anchorEl}\n                            onClose={handleClose}\n                            open={Boolean(anchorEl)}>\n                            <CopyToClipboard text={\"http://localhost:8099/detail/\" + item.id}>\n                            <MenuItem onClick={()=>{\n                                toast.info(\"Link to post copied to clipboard.\", \n                                        {\n                                            position: \"bottom-right\", \n                                            hideProgressBar: true,\n                                            autoClose: 1000,\n                                        }) \n\n                                handleClose()\n                            }}>Copy link</MenuItem>\n                            </CopyToClipboard>\n                            <MenuItem onClick={()=>{\n\n                                if(isEmpty(props.user)){\n                                    setShowModalLogin(true)\n                                }else{\n                                    setShowModalReport(true)\n                                }\n\n                                handleClose()\n                            }}>Report</MenuItem>\n                        </Menu> \n\n                        { showModalLogin &&  <LoginDialog showModal={showModalLogin} onClose = {()=>{ setShowModalLogin(false) }} />}\n\n                    </div> \n            }\n        </div>\n    );\n};\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n      user: state.user.data,\n      data: state.app.data,\n      my_follows: state.my_follows.data,\n    };\n}\n  \nconst mapDispatchToProps = {\n    // fetchData,\n}\n  \nexport default connect(mapStateToProps, mapDispatchToProps)(DetailPage)"]},"metadata":{},"sourceType":"module"}