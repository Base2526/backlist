{"ast":null,"code":"import { ADD_CONTENTS_DATA, CLEAR_ALL_CONTENTS_DATA, MY_FOLLOW } from '../constants';\n\nvar _ = require('lodash');\n\nvar merge = (a, b, p) => a.filter(aa => !b.find(bb => aa[p] === bb[p]));\n\nconst initialState = {\n  data: []\n};\n\nconst app = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_CONTENTS_DATA:\n      {\n        var merged = _.merge(_.keyBy(state.data, 'nid'), _.keyBy(action.data, 'nid'));\n\n        return { ...state,\n          data: _.values(merged)\n        };\n      }\n\n    case MY_FOLLOW:\n      {\n        let state_data = state.data;\n        let action_data = action.data;\n        let index = state_data.findIndex(obj => obj.nid == action_data.nid);\n        let __t = state_data[index];\n\n        if (!_.isEmpty(__t)) {\n          let app_followers = __t.app_followers;\n\n          let _index = app_followers.findIndex(obj => obj.uid == action_data.uid);\n\n          if (_index === -1) {\n            app_followers = [...app_followers, {\n              uid: action_data.uid,\n              status: true,\n              date: Date.now()\n            }];\n          } else {\n            // app_followers[_index].status = !app_followers[_index].status\n            app_followers = app_followers.splice(_index, 1, {\n              uid: action_data.uid,\n              status: _.isEmpty(app_followers[_index].status) ? true : false,\n              date: app_followers[_index].date\n            });\n            console.log('app_followers :', app_followers);\n          }\n\n          state_data.splice(index, 1, { ...__t,\n            app_followers\n          });\n        }\n\n        return { ...state,\n          data: state_data\n        };\n      }\n\n    case CLEAR_ALL_CONTENTS_DATA:\n      {\n        return initialState;\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default app;","map":{"version":3,"sources":["/app/src/reducers/app.js"],"names":["ADD_CONTENTS_DATA","CLEAR_ALL_CONTENTS_DATA","MY_FOLLOW","_","require","merge","a","b","p","filter","aa","find","bb","initialState","data","app","state","action","type","merged","keyBy","values","state_data","action_data","index","findIndex","obj","nid","__t","isEmpty","app_followers","_index","uid","status","date","Date","now","splice","console","log"],"mappings":"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","sourcesContent":["import { ADD_CONTENTS_DATA, CLEAR_ALL_CONTENTS_DATA, MY_FOLLOW } from '../constants';\n\nvar _ = require('lodash');\n\nvar merge = (a, b, p) => a.filter(aa =>!b.find(bb => aa[p] === bb[p]));\nconst initialState = {\n  data: []\n}\n\nconst app = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_CONTENTS_DATA:{\n      var merged = _.merge(_.keyBy(state.data, 'nid'), _.keyBy(action.data, 'nid'));\n  \n      return { ...state, data: _.values(merged)}\n    }\n\n    case MY_FOLLOW:{\n      let state_data  = state.data\n      let action_data = action.data;\n\n      let index = state_data.findIndex((obj => obj.nid == action_data.nid));\n      \n      let __t = state_data[index];\n      if(!_.isEmpty(__t)){\n        let app_followers = __t.app_followers\n\n        let _index = app_followers.findIndex((obj => obj.uid == action_data.uid));\n        if(_index === -1){\n          app_followers = [...app_followers, {uid: action_data.uid, status: true, date  : Date.now()}]\n        }else{\n          // app_followers[_index].status = !app_followers[_index].status\n\n          app_followers = app_followers.splice(_index, 1, {uid: action_data.uid, status: (_.isEmpty(app_followers[_index].status) ? true : false), date  :app_followers[_index].date})\n        \n          console.log('app_followers :', app_followers )\n        }\n\n        state_data.splice(index,1, {...__t, app_followers})\n      }\n\n      return { ...state, data: state_data};\n    }\n\n    case CLEAR_ALL_CONTENTS_DATA:{\n      return initialState\n    }\n      \n    default:\n      return state;\n  }\n}\n\nexport default app"]},"metadata":{},"sourceType":"module"}